$(function(){obj={submit:function(){var e=$("#lic_text").val();0===e.length?layer.msg(StrackLang.Please_Input_License,{icon:2,time:2e3,anim:6}):$.ajax({type:"POST",dataType:"json",url:ErrorPHP.validationLicense,data:{license:e},beforeSend:function(){layer.load(1,{shade:[.5,"#fff"]})},success:function(e){layer.closeAll(),200===parseInt(e.status)?layer.msg(e.message,{icon:1,shade:.01,time:2e3},function(){location.href=ErrorPHP.login_page}):(208004===parseInt(e.status)&&($("#adjust_active_user").show(),r=parseInt(e.data.current_number)-parseInt(e.data.license_number),$("#cancel_current_user_number span").html(e.data.current_number),$("#cancel_lic_user_number span").html(r)),layer.msg(e.message,{icon:2,time:2e3,anim:6}))}})},download_file:function(){window.open(ErrorPHP.getRequestFile)}};var r=0;$.ajax({type:"POST",dataType:"json",url:ErrorPHP.getLicenseRequestData,beforeSend:function(){layer.load(1,{shade:[.5,"#fff"]})},success:function(e){var a=$("#lic_request");0===parseInt(e.length)?a.empty().append(StrackLang.No_Authorized_History):($("#old_lic_user_number span").html(e.user_number),$("#old_lic_expire_date span").html(e.expiry_date),$("#old_lic_expire_days span").html(Math.abs(e.expiry_days))),layer.closeAll()}}),$("#datagrid_box").dataTable({check:!0,pageCapacity:0,loading:!0,serial:!1,method:"POST",url:ErrorPHP.getActiveUserGridData,style:{"font-size":"12px",width:"100%"},align:"center",ButtonStyle:{fontColor:"#ffffff",backgroundColor:"#1890ff"},columns:[{title:StrackLang.Cancel_User,button:"del",buttonName:StrackLang.Cancel_User,width:50},{ColumnName:"id",title:StrackLang.ID,width:30},{ColumnName:"login_name",title:StrackLang.Login_Name,width:300},{ColumnName:"name",title:StrackLang.User_Name,width:300},{ColumnName:"nickname",title:StrackLang.Nickname,width:300}],delClick:function(e,a){var t,n;t=e,n=a.id,$.ajax({type:"POST",url:ErrorPHP.cancelAccount,data:{user_id:n},dataType:"json",beforeSend:function(){layer.load(1,{shade:[.5,"#fff"]})},success:function(e){r--,$("#cancel_lic_user_number span").html(r),$(t).closest("tr").remove(),0===r&&obj.submit(),layer.closeAll()}})}})});