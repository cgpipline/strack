$(function(){obj={base_add:function(e){e=$(e).data("lang");Strack.item_operate_dialog(e,{mode:"create",field_list_type:["edit"],module_id:d.module_id,project_id:d.project_id,page:d.page,schema_page:d.page,type:"add_panel",keep_panel:!0},function(){obj.reset_base()})},base_edit:function(e){var i=$(e).data("lang");Strack.get_datagrid_select_data("#main_datagrid_box",function(e){Strack.item_operate_dialog(i,{mode:"modify",field_list_type:["edit"],module_id:d.module_id,project_id:d.project_id,page:d.page,schema_page:d.page,type:"update_panel",primary_id:e.join(",")},function(){obj.reset_base()})})},base_delete:function(e){Strack.ajax_grid_delete("main_datagrid_box","id",StrackLang.Delete_Base_Notice,StrackPHP.deleteGridData,d)},reset_base:function(){$("#main_datagrid_box").datagrid("reload")}};var d=Strack.generate_hidden_param();d.grid_page_id=d.module_code+"_grid_"+d.project_id,d.schema_page=d.page,Strack.load_grid_columns("#grid_datagrid_main",{loading_id:".projpage-main",page:d.page,schema_page:d.page,module_id:d.module_id,project_id:d.project_id,grid_id:"main_datagrid_box",view_type:"grid",temp_fields:{add:{},cut:{}}},function(e){var i={filter:{temp_fields:{add:{},cut:{}},group:e.grid.group_name,sort:e.grid.sort_config.sort_query,request:[{field:"project_id",field_type:"built_in",editor:"combobox",value:d.project_id,condition:"EQ",module_code:d.module_code,table:"Base"}],filter_input:e.grid.filter_config.filter_input,filter_panel:e.grid.filter_config.filter_panel,filter_advance:e.grid.filter_config.filter_advance},page:d.page,schema_page:d.page,module_id:d.module_id,module_type:d.module_type,module_code:d.module_code,project_id:d.project_id},a=Strack.check_whether_use_kanban_view(d.module_code,e),i={url:BasePHP.getBaseGridData,height:Strack.panel_height("#grid_datagrid_main",0),view:a.checkData.use_view,isKanban:a.checkData.use_kanban_view,showHeader:a.checkData.show_header,rowheight:50,differhigh:!1,singleSelect:!1,adaptive:{dom:".base-m-grid",min_width:680,exth:0,domresize:1},ctrlSelect:!0,multiSort:!0,DragSelect:!0,moduleId:d.module_id,projectId:d.project_id,queryParams:{filter_data:JSON.stringify(i)},panelConfig:{active_filter_id:e.grid.filter_config.filter_id},sortConfig:e.grid.sort_config,sortData:e.grid.sort_config.sort_data,toolbarConfig:{id:"grid_datagrid_main",page:d.page,sortAllow:!0,groupAllow:!0,fieldAllow:!0,viewAllow:!0,actionAllow:!0},searchConfig:{id:"main_grid_search",bar_show:e.grid.filter_bar_show,filterBar:{main_dom:"grid_datagrid_main",bar_dom:"grid_filter_main"}},filterConfig:{id:"grid_filter_main",schema_page:d.page,barParam:{}},authorityRules:{filter:{show:d.rule_panel_filter,edit:d.rule_modify_filter},sort:d.rule_sort,group:d.rule_group},contextMenuData:{id:"st_menu_base",copy_id:"ac_copy_cell",edit_id:"#grid_datagrid_main .edit-menu",data:[]},columnsFieldConfig:e.grid.columnsFieldConfig,frozenColumns:e.grid.frozenColumns,columns:e.grid.columns,toolbar:"#tb_grid",pagination:a.checkData.use_pagination,pageNumber:1,pageSize:200,pageList:[100,200,300,400,500],pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(e,i){d.item_id=i.id,d.entity_id=i.base_entity_id,Strack.open_datagrid_slider(d)}};i.groupParam={group_param:a.groupParam,grid_param:d,grid_data:e},a.checkData.use_kanban_view?$("#main_datagrid_box").datagrid(i):($.isEmptyObject(e.grid.group_name)||(i.groupActive=!0,i.groupField=Strack.get_grid_group_field(e.grid.group_name).field,i.groupFormatter=function(e,i){return'<span class="">'+e+"( "+i.length+" )</span>"}),$("#main_datagrid_box").datagrid(i).datagrid("enableCellEditing").datagrid("disableCellSelecting").datagrid("gotoCell",{index:0,field:"id"}).datagrid("columnMoving"))})});