$(function(){obj={switch_tab:function(e){m($(e).data("tab"))},member_add:function(e){e=$(e).data("lang");Strack.item_operate_dialog(e,{mode:"create",field_list_type:["edit"],module_id:3,project_id:d.project_id,page:"project_member",schema_page:"project_member",type:"add_panel"},function(){obj.reset_member()})},member_edit:function(e){var t=$(e).data("lang");Strack.get_datagrid_select_data("#team_datagrid_box",function(e){Strack.item_operate_dialog(t,{mode:"modify",field_list_type:["edit"],module_id:3,project_id:d.project_id,page:"project_member",schema_page:"project_member",type:"update_panel",primary_id:e.join(",")},function(){obj.reset_member()})})},member_delete:function(e){Strack.ajax_grid_delete("team_datagrid_box","id",StrackLang.Delete_Member_Notice,StrackPHP.deleteGridData,d)},reset_member:function(){$("#team_datagrid_box").datagrid("reload")},nav_auto_save:function(e){e=$(e);t=e.hasClass("active")?(e.removeClass("active"),e.find("i").removeClass("icon-checked").addClass("icon-unchecked"),!1):(e.addClass("active"),e.find("i").removeClass("icon-unchecked").addClass("icon-checked"),!0)},nav_save:function(e){u()},select_module:function(e){var t,a=$(e).data("tabname"),i={module_id:$(e).data("moduleid"),module_name:$(e).data("modulename"),module_type:$(e).data("moduletype"),module_code:$(e).data("modulecode"),template_id:d.template_id,filter:""};switch($(".nation-items").removeClass("admin-bid-ac"),$(e).addClass("admin-bid-ac"),a){case"status":c=i,(t=$("#status_config")).hasClass("visible")||(t.addClass("visible"),$("#status_config_notice").hide(),t.find(".p-status-allow").show(),t.find(".p-status-now").show()),v();break;case"step":_=i,(t=$("#step_config")).hasClass("visible")||(t.addClass("visible"),$("#step_config_notice").hide(),t.find(".p-status-allow").show(),t.find(".p-status-now").show()),S()}},status_add:function(e){Strack.open_dialog("dialog",{title:StrackLang.Add_Status_Title,width:480,height:400,content:Strack.dialog_dom({type:"normal",hidden:[],items:[{case:1,id:"Mstatus_name",type:"text",lang:StrackLang.Name,name:"name",valid:"1,128",value:""},{case:1,id:"Mstatus_code",type:"text",lang:StrackLang.Code,name:"code",valid:"1,128",value:""},{case:2,id:"Mstatus_color",lang:StrackLang.Color,name:"color",valid:"6,6"},{case:2,id:"Mstatus_Icon",lang:StrackLang.Icon,name:"icon",valid:"1,24"},{case:2,id:"Mstatus_Cponds",lang:StrackLang.Corresponds,name:"correspond",valid:"1"}],footer:[{obj:"status_submit",type:1,title:StrackLang.Submit},{obj:"dialog_cancel",type:8,title:StrackLang.Cancel}]}),inits:function(){Strack.color_pick_widget("#Mstatus_color","hex","light","",320),Strack.combobox_widget("#Mstatus_Icon",{url:StrackPHP.getIconList,valueField:"icon",textField:"icon",formatter:function(e){return'<div class="combo-icons-warp" style="overflow: hidden"><div class="combo-icons aign-left"><i class="'+e.icon+'"></i></div><div class="combo-name">'+e.icon+"</div></div>"}}),Strack.combobox_widget("#Mstatus_Cponds",{url:StrackPHP.getStatusCorresponds,valueField:"id",textField:"name"}),$("#Mstatus_code").inputmask("alphaDash")},close:function(){}})},status_submit:function(e){Strack.ajax_dialog_form("#st_dialog_form .dialog-widget-val","",ProjectPHP.addStatus,{back:function(e){200===parseInt(e.status)?(Strack.dialog_cancel(),c.filter=e.data.name,$("#status_search").val(e.data.name),v(),Strack.top_message({bg:"g",msg:e.message})):layer.msg(e.message,{icon:7,time:1200,anim:6})}})},filter_status:function(e){c.filter=$("#status_search").val(),v()},add_status_to_drag:function(e){var t,a,i,s=$(e).attr("data-statusid");"no"===$(e).attr("data-checked")?(t="icon-uniF068",a="yes",$("#status_drag_list").find(".temp-setlist-no").remove(),n[s]=o[s],i=o[s],$("#status_drag_list").prepend(k(i)),f()):(t="icon-uniF067",a="no",$("#drag_status_item_"+s).remove(),0===$(".drag-status-item").length&&$("#status_drag_list").empty().append('<div class="temp-setlist-no"><p>'+StrackLang.Please_Select_One_Status+"</p></div>")),$(e).attr("data-checked",a),$(e).empty().append('<i class="'+t+'"></i>'),b()},drag_status_save:function(e){h()},drag_status_auto_save:function(e){e=$(e);a=e.hasClass("active")?(e.removeClass("active"),e.find("i").removeClass("icon-checked").addClass("icon-unchecked"),!1):(e.addClass("active"),e.find("i").removeClass("icon-unchecked").addClass("icon-checked"),!0)},step_add:function(e){Strack.open_dialog("dialog",{title:StrackLang.Add_Step_Title,width:480,height:320,content:Strack.dialog_dom({type:"normal",hidden:[],items:[{case:1,id:"Mstep_name",type:"text",lang:StrackLang.Name,name:"name",valid:"1,128",value:""},{case:1,id:"Mstep_code",lang:StrackLang.Code,name:"code",valid:"1,128",value:""},{case:2,id:"Mstep_color",lang:StrackLang.Color,name:"color",valid:"6,6"}],footer:[{obj:"step_submit",type:1,title:StrackLang.Update},{obj:"dialog_cancel",type:8,title:StrackLang.Cancel}]}),inits:function(){Strack.color_pick_widget("#Mstep_color","hex","light","",320),$("#Mstep_code").inputmask("alphaDash")},close:function(){}})},step_submit:function(e){Strack.ajax_dialog_form("#st_dialog_form .dialog-widget-val","",ProjectPHP.addStep,{back:function(e){200===parseInt(e.status)?(Strack.dialog_cancel(),_.filter=e.data.name,$("#step_search").val(e.data.name),S(),Strack.top_message({bg:"g",msg:e.message})):layer.msg(e.message,{icon:7,time:1200,anim:6})}})},filter_step:function(e){_.filter=$("#step_search").val(),S()},add_step_to_drag:function(e){var t,a,i,s=$(e).attr("data-stepid");"no"===$(e).attr("data-checked")?(t="icon-uniF068",a="yes",$("#step_drag_list").find(".temp-setlist-no").remove(),l[s]=r[s],i=r[s],$("#step_drag_list").prepend(y(i)),j()):(t="icon-uniF067",a="no",$("#drag_step_item_"+s).remove(),0===$(".drag-step-item").length&&$("#step_drag_list").empty().append('<div class="temp-setlist-no"><p>'+StrackLang.Please_Select_One_Step+"</p></div>")),$(e).attr("data-checked",a),$(e).empty().append('<i class="'+t+'"></i>'),w()},drag_step_save:function(e){P()},drag_step_auto_save:function(e){e=$(e);i=e.hasClass("active")?(e.removeClass("active"),e.find("i").removeClass("icon-checked").addClass("icon-unchecked"),!1):(e.addClass("active"),e.find("i").removeClass("icon-unchecked").addClass("icon-checked"),!0)},nav_add_disk:function(e){Strack.open_dialog("dialog",{title:StrackLang.Add_Entity_Disk_Title,width:480,height:370,content:Strack.dialog_dom({type:"normal",hidden:[],items:[{case:1,id:"Ndisk_name",type:"text",lang:StrackLang.Name,name:"name",valid:"1",value:""},{case:1,id:"Ndisk_code",type:"text",lang:StrackLang.Code,name:"code",valid:"1",value:""},{case:1,id:"Nwin_path",type:"text",lang:StrackLang.Win_Path,name:"win_path",valid:"",value:""},{case:1,id:"Nmac_path",type:"text",lang:StrackLang.Mac_Path,name:"mac_path",valid:"",value:""},{case:1,id:"Nlinux_path",type:"text",lang:StrackLang.Linux_Path,name:"linux_path",valid:"",value:""}],footer:[{obj:"submit_add_disk",type:1,title:StrackLang.Submit},{obj:"dialog_cancel",type:8,title:StrackLang.Cancel}]}),inits:function(){}})},submit_add_disk:function(){Strack.ajax_dialog_form("#st_dialog_form .dialog-widget-val","",StrackPHP.addProjectDisk,{back:function(e){var t;200===parseInt(e.status)?($("#overview_disk").find(".combobox-f").each(function(){t=$(this).attr("id"),$("#"+t).combobox("reload")}),Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:e.message})):layer.msg(e.message,{icon:7,time:1200,anim:6})}})},add_more_disk:function(e){Strack.open_dialog("dialog",{title:StrackLang.Add_More_Disk_Title,width:480,height:280,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mdisk_id",type:"hidden",name:"disk_id",valid:1,value:d.disk_id}],items:[{case:1,id:"Mdisk_name",type:"text",lang:StrackLang.Name,name:"name",valid:"1",value:""},{case:1,id:"Mdisk_code",type:"text",lang:StrackLang.Code,name:"code",valid:"1",value:""},{case:2,id:"Mdisk_list",lang:StrackLang.Disks,name:"id",valid:"1"}],footer:[{obj:"add_more_project_disk",type:1,title:StrackLang.Submit},{obj:"dialog_cancel",type:8,title:StrackLang.Cancel}]}),inits:function(){Strack.combobox_widget("#Mdisk_list",{url:StrackPHP.getDiskCombobox,valueField:"id",textField:"name"})}})},add_more_project_disk:function(){Strack.ajax_dialog_form("#st_dialog_form .dialog-widget-val","",StrackPHP.addProjectMoreDisk,{back:function(e){var t;200===parseInt(e.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:e.message}),t=e.data,$("#entity_disk_list").prepend(x(t)),Strack.combobox_widget("#disk_"+t.code,{url:StrackPHP.getDiskCombobox,prompt:StrackLang.Please_Select_Disk,valueField:"id",textField:"name",value:t.id,width:300,height:30,onSelect:function(e){t.disk_id=d.disk_id,C(t,e)}}),obj.check_more_project_disk_notice()):layer.msg(e.message,{icon:7,time:1200,anim:6})}})},delete_more_project_disk:function(e){var t=$(e).attr("data-code");$.ajax({type:"POST",url:StrackPHP.deleteProjectMoreDisk,data:{disk_id:d.disk_id,code:t},dataType:"json",beforeSend:function(){$.messager.progress({title:StrackLang.Waiting,msg:StrackLang.loading})},success:function(e){$.messager.progress("close"),200===parseInt(e.status)?(Strack.top_message({bg:"g",msg:e.message}),$("#item_disk_"+t).remove(),obj.check_more_project_disk_notice()):layer.msg(e.message,{icon:7,time:1200,anim:6})}})},check_more_project_disk_notice:function(){0<$("#entity_disk_list .disk-setting-item").length?$("#entity_disk_list .datagrid-empty-no").remove():$("#entity_disk_list").html('<div class="datagrid-empty-no">'+StrackLang.No_More_Disks_Configured+"</div>")}};var d=Strack.generate_hidden_param();d.item_id=d.project_id;var s={},t=!1,o={},n={},a=!1,c={},r={},l={},i=!1,_={};function m(e){switch($(".media-m-item").removeClass("media-m-w-active").each(function(){$(this).data("tab")===e&&$(this).addClass("media-m-w-active")}),function(e,t){var a=d.project_id+".html";t&&(a+="?"+t);history.replaceState(null,e,a)}(e,"tab="+e),e){case"details":(t=d).category="project_overview",Strack.load_info_panel({id:"#project_base_info",mask:"project_info",pos:"max",url:StrackPHP.getProjectInfo,data:t,loading_type:"white"},function(e){e=e.media_data;e.link_id=d.project_id,e.module_id=d.module_id,e.param.icon="icon-uniF1ED",Strack.thumb_media_widget("#project_base_thumb",e,{modify_thumb:d.rule_thumb_modify,clear_thumb:d.rule_thumb_clear})});break;case"team":Strack.load_grid_columns("#team_datagrid_main",{loading_id:".team_datagrid_main",page:"project_member",schema_page:"project_member",module_id:d.project_member_module_id,project_id:d.project_id,grid_id:"team_datagrid_box",view_type:"grid",temp_fields:{add:{},cut:{}}},function(e){var t={filter:{temp_fields:{add:{},cut:{}},group:e.grid.group_name,sort:e.grid.sort_config.sort_query,request:[{field:"project_id",field_type:"built_in",editor:"combobox",value:d.project_id,condition:"EQ",module_code:"project_member",table:"ProjectMember"}],filter_input:e.grid.filter_config.filter_input,filter_panel:e.grid.filter_config.filter_panel,filter_advance:e.grid.filter_config.filter_advance},page:"project_member",schema_page:"project_member",module_id:d.project_member_module_id,module_type:d.project_member_module_type,module_code:d.project_member_module_code,project_id:d.project_id},t={url:ProjectPHP.getProjectTeamMembers,height:Strack.panel_height(".p-group-full",0),view:scrollview,rowheight:50,differhigh:!1,singleSelect:!1,adaptive:{dom:".base-m-grid",min_width:680,exth:0,domresize:1},ctrlSelect:!0,multiSort:!0,DragSelect:!0,moduleId:d.project_member_module_id,projectId:d.project_id,queryParams:{filter_data:JSON.stringify(t)},panelConfig:{active_filter_id:e.grid.filter_config.filter_id},sortConfig:e.grid.sort_config,sortData:e.grid.sort_config.sort_data,toolbarConfig:{id:"team_datagrid_main",page:"project_member",sortAllow:!0,groupAllow:!0,fieldAllow:!0,viewAllow:!0,actionAllow:!0},searchConfig:{id:"team_grid_search",bar_show:e.grid.filter_bar_show,filterBar:{main_dom:"team_datagrid_main",bar_dom:"team_filter_main"}},filterConfig:{id:"team_filter_main",schema_page:"project_member",barParam:{}},authorityRules:{filter:{show:d.rule_team_panel_filter,edit:d.rule_team_modify_filter},sort:d.rule_team_sort,group:d.rule_team_group},contextMenuData:{id:"st_menu_project_team",copy_id:"ac_copy_cell",edit_id:"#team_datagrid_main .edit-menu",data:[]},columnsFieldConfig:e.grid.columnsFieldConfig,frozenColumns:e.grid.frozenColumns,columns:e.grid.columns,toolbar:"#team_tb",pagination:!0,pageNumber:1,pageSize:200,pageList:[100,200,300,400,500],pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(e,t){}};$.isEmptyObject(e.grid.group_name)||(t.groupActive=!0,t.groupField=Strack.get_grid_group_field(e.grid.group_name).field,t.groupFormatter=function(e,t){return'<span class="">'+e+"( "+t.length+" )</span>"}),$("#team_datagrid_box").datagrid(t).datagrid("enableCellEditing").datagrid("disableCellSelecting").datagrid("gotoCell",{index:0,field:"id"}).datagrid("columnMoving")});break;case"navigation":$.ajax({type:"POST",url:ProjectPHP.getProjectNavSetting,dataType:"json",data:{category:"navigation",module_code:d.module_code,module_id:d.module_id,project_id:d.project_id,template_id:d.template_id},beforeSend:function(){s={}},success:function(e){var a=$("#nav_module_list");a.empty();var i=!1;e.forEach(function(e){a.append((t="",t+='<li class="text-no-select"><div class="overview-nav-item" data-moduleid="'+e.module_id+'" data-swicthid="'+e.code+'_nav_swicth"><div class="overview-nav-handle aign-left"><i class="icon-uniE6A1"></i></div><div class="overview-nav-icon aign-left"><i class="'+e.icon+'"></i></div><div class="overview-nav-title aign-left"><div class="nav-name text-ellipsis">'+e.name+'</div><div class="nav-description text-ellipsis">'+e.type_name+'</div></div><div class="overview-nav-swicth aign-left"><input id="'+e.code+'_nav_swicth" /></div></div></li>'));var t="yes"===e.checked?1:0;i="overview"===e.code||"yes"!==d.rule_navigation_switch_button,s[e.module_id]=e,Strack.init_open_switch({dom:"#"+e.code+"_nav_swicth",disabled:i,value:t,onText:StrackLang.Switch_ON,offText:StrackLang.Switch_OFF,width:100,height:26},function(e){g()})}),"yes"===d.rule_navigation_drag&&Sortable.create(Strack.get_obj_by_id("nav_module_list"),{animation:150,forceFallback:!0,filter:".overview-nav-swicth",onEnd:function(e){g()}})}});break;case"status":case"step":p(e);break;case"disk":$.ajax({type:"POST",url:ProjectPHP.getProjectDiskConfig,data:JSON.stringify(d),dataType:"json",contentType:"application/json",beforeSend:function(){$("#overview_disk").prepend(Strack.loading_dom("white","","disk"))},success:function(t){var a,e=$("#entity_disk_list"),i="yes"!==d.rule_disk_modify,s="";for(a in e.empty(),t)"default"===a?s=t[a].id:(e.append(x(t[a])),Strack.combobox_widget("#disk_"+t[a].code,{url:StrackPHP.getDiskCombobox,prompt:StrackLang.Please_Select_Disk,valueField:"id",textField:"name",disabled:i,value:t[a].id,width:300,height:30,onSelect:function(e){t[a].disk_id=d.disk_id,C(t[a],e)}}));Strack.combobox_widget("#disk_global_combobox",{url:StrackPHP.getDiskCombobox,prompt:StrackLang.Please_Select_Disk,valueField:"id",textField:"name",disabled:i,value:s,width:300,height:30,onSelect:function(e){C({disk_id:d.disk_id,name:StrackLang.Default,code:"default"},e)}}),obj.check_more_project_disk_notice(),$("#st-load_disk").remove()}})}var t;$(".pitem-wrap").removeClass("active").each(function(){$(this).data("tab")===e&&$(this).addClass("active")})}function g(){t&&u()}function u(){var e,t,a=[];$(".overview-nav-item").each(function(){e=Strack.get_switch_val("#"+$(this).attr("data-swicthid")),t=$(this).attr("data-moduleid"),1===parseInt(e)&&a.push(s[t])}),$.ajax({type:"POST",url:ProjectPHP.modifyProjectNavTemplateConfig,data:JSON.stringify({category:"navigation",module_code:d.module_code,module_id:d.module_id,project_id:d.project_id,template_id:d.template_id,config:a}),dataType:"json",contentType:"application/json",beforeSend:function(){$("#tab_navigation").prepend(Strack.loading_dom("white","","navigation"))},success:function(e){Strack.top_message({bg:"g",msg:e.message}),$("#st-load_navigation").remove(),200===parseInt(e.status)&&(e.data.forEach(function(e){s[e.module_id]=e}),Strack.refresh_top_menu(e.menu_data))}})}function p(i){var e=$("#"+i+"_module_list");$.ajax({url:ProjectPHP.getProjectOverviewModuleList,type:"POST",dataType:"json",data:{tab_name:i,template_id:d.template_id},beforeSend:function(){e.append(Strack.loading_dom("white","","module"))},success:function(t){var a="";["fixed","entity"].forEach(function(e){t[e]&&(a+='<li class="module-items-title">'+t[e].title+"</li>",t[e].data.forEach(function(e){var t;a+=(t="",t+='<a href="javascript:;" class="nation-items" onclick="obj.select_module(this)" data-tabname="'+i+'" data-moduleid="'+e.id+'" data-modulename="'+e.name+'" data-moduletype="'+e.type+'" data-modulecode="'+e.code+'"><div class="nation-items-wrap middle"><div class="aign-left"><i class="'+e.icon+' icon-left"></i><span>'+e.name+"</span></div></div></a>")}))}),e.empty().append(a),$("#st-load_module").remove()}})}function v(){$.ajax({url:ProjectPHP.getProjectOverviewStatusList,type:"POST",dataType:"json",data:c,beforeSend:function(){o={},$("#module_status_list").append(Strack.loading_dom("white","","module_status"))},success:function(e){var a="",i=e.status_list;["blocked","not_started","in_progress","daily","done","hide"].forEach(function(t){0<i[t].data.length&&(a+='<li class="module-items-title">'+i[t].title+"</li>",i[t].data.forEach(function(e){e.corresponds_lang=i[t].title,a+=function(e){var t="",a="yes"===e.checked?"icon-uniF068":"icon-uniF067";t+='<li class="nation-items"><div class="nation-items-wrap middle"><div class="aign-left"><i class="'+e.icon+' icon-left" style="color:#'+e.color+'"></i>'+e.name+"</div>","yes"===d.rule_status_save&&(t+='<a href="javascript:;" onclick="obj.add_status_to_drag(this);" class="aign-right" data-statusid="'+e.id+'" data-checked="'+e.checked+'"><i class="'+a+'"></i></a>');return t+="</div></li>"}(e),o[e.id]=e}))}),0<a.length?$("#module_status_list").empty().append(a):$("#module_status_list").empty().append('<div class="temp-setlist-no"><p>'+StrackLang.Datagird_No_Data+"</p></div>");var t="";e.status_checked.forEach(function(e){n[e.id]=e,t+=k(e)}),0<t.length?($("#status_drag_list").empty().append(t),"yes"===d.rule_status_drag&&f()):$("#status_drag_list").empty().append('<div class="temp-setlist-no"><p>'+StrackLang.Please_Select_One_Status+"</p></div>")}})}function f(){Sortable.create(Strack.get_obj_by_id("status_drag_list"),{animation:150,forceFallback:!0,onEnd:function(e){b()}})}function k(e){var t="";return t+='<li class="text-no-select"><div id="drag_status_item_'+e.id+'" class="drag-status-item" data-statusid="'+e.id+'"><div class="overview-nav-handle aign-left"><i class="icon-uniE6A1"></i></div><div class="overview-nav-icon aign-left"><i class="'+e.icon+'" style="color:#'+e.color+'"></i></div><div class="overview-nav-title aign-left"><div class="nav-name text-ellipsis">'+e.name+'</div><div class="nav-description text-ellipsis">'+e.corresponds_lang+"</div></div></div></li>"}function h(){var e,t=[];$(".drag-status-item").each(function(){e=$(this).attr("data-statusid"),t.push(n[e])}),c.new_status_config=t,$.ajax({type:"POST",url:ProjectPHP.modifyModuleStatusConfig,data:JSON.stringify(c),dataType:"json",contentType:"application/json",beforeSend:function(){$("#status_config").prepend(Strack.loading_dom("white","","status"))},success:function(e){200===parseInt(e.status)?Strack.top_message({bg:"g",msg:e.message}):Strack.top_message({bg:"r",msg:e.message}),$("#st-load_status").remove()}})}function b(){a&&h()}function S(){$.ajax({url:ProjectPHP.getProjectOverviewStepList,type:"POST",dataType:"json",data:_,beforeSend:function(){r={},$("#module_step_list").append(Strack.loading_dom("white","","module_step"))},success:function(e){var t="";e.step_list.forEach(function(e){t+=function(e){var t="",a="yes"===e.checked?"icon-uniF068":"icon-uniF067";t+='<li class="nation-items"><div class="nation-items-wrap middle"><div class="aign-left"><span class="nation-items-label icon-left" style="background-color:#'+e.color+'"></span>'+e.name+"</div>","yes"===d.rule_step_save&&(t+='<a href="javascript:;" onclick="obj.add_step_to_drag(this);" class="aign-right" data-stepid="'+e.id+'" data-checked="'+e.checked+'"><i class="'+a+'"></i></a>');return t+="</div></li>"}(e),r[e.id]=e}),0<t.length?$("#module_step_list").empty().append(t):$("#module_step_list").empty().append('<div class="temp-setlist-no"><p>'+StrackLang.Datagird_No_Data+"</p></div>");var a="";e.step_checked.forEach(function(e){l[e.id]=e,a+=y(e)}),0<a.length?($("#step_drag_list").empty().append(a),"yes"===d.rule_step_drag&&j()):$("#step_drag_list").empty().append('<div class="temp-setlist-no"><p>'+StrackLang.Please_Select_One_Step+"</p></div>")}})}function y(e){var t="";return t+='<li class="text-no-select"><div id="drag_step_item_'+e.id+'" class="drag-step-item" data-stepid="'+e.id+'"><div class="overview-nav-handle aign-left"><i class="icon-uniE6A1"></i></div><div class="overview-nav-icon aign-left" style="background-color:#'+e.color+'"></div><div class="overview-nav-title aign-left"><div class="nav-name text-ellipsis">'+e.name+'</div><div class="nav-description text-ellipsis">'+e.code+"</div></div></div></li>"}function j(){Sortable.create(Strack.get_obj_by_id("step_drag_list"),{animation:150,forceFallback:!0,onEnd:function(e){w()}})}function w(){i&&P()}function P(){var e,t=[];$(".drag-step-item").each(function(){e=$(this).attr("data-stepid"),t.push(l[e])}),_.new_step_config=t,$.ajax({type:"POST",url:ProjectPHP.modifyModuleStepConfig,data:JSON.stringify(_),dataType:"json",contentType:"application/json",beforeSend:function(){$("#step_config").prepend(Strack.loading_dom("white","","step"))},success:function(e){200===parseInt(e.status)?Strack.top_message({bg:"g",msg:e.message}):Strack.top_message({bg:"r",msg:e.message}),$("#st-load_step").remove()}})}function x(e){var t="",a="disk_"+e.code;return t+='<div id="item_'+a+'" class="ui grid disk-setting-item"><div class="two column row"><div class="five wide column"><a href="javascript:;" class="delete-bnt" onclick="obj.delete_more_project_disk(this)" data-code="'+e.code+'"><i class="icon-uniE6DB"></i></a><span class="title">'+e.name+'</span></div><div class="eleven wide column combobox"><input id="'+a+'" autocomplete="off"/></div></div></div>'}function C(e,t){$.ajax({type:"POST",url:ProjectPHP.modifyProjectDisk,data:JSON.stringify({param:e,data:t}),dataType:"json",contentType:"application/json",beforeSend:function(){$.messager.progress({title:StrackLang.Waiting,msg:StrackLang.loading})},success:function(e){$.messager.progress("close"),200===parseInt(e.status)?Strack.top_message({bg:"g",msg:e.message}):layer.msg(e.message,{icon:7,time:1200,anim:6})}})}Strack.listen_keyboard_event(function(e,t){"enter"===t.code&&($("#status_search").is(":focus")&&(e.preventDefault(),obj.filter_status(Strack.get_obj_by_id("search_status_bnt"))),$("#step_search").is(":focus")&&(e.preventDefault(),obj.filter_step(Strack.get_obj_by_id("search_step_bnt"))))}),function(){var e=Strack.read_storage(d.page);e&&Strack.toggle_media_menu(Strack.get_obj_by_id("overview_left_menu"),e);d.url_tab&&"yes"===d["rule_tab_"+d.url_tab]?m(d.url_tab):(e=function(){var t="";return["details","team","navigation","status","step","disk"].forEach(function(e){if("yes"===d["rule_tab_"+e]&&!t)return t=e,!1}),t}())&&m(e)}()});